<script src="zaza.js" charset="utf-8"></script>
<script src="/sdk/v1/bridge/bridge.js" charset="utf-8"></script>

<div id="logger"></div>

<script>
    // Log to a div
    let console = {};
    let logger = document.getElementById("logger");
    console.log = text => {
        let element = document.createElement("div");
        let txt = document.createTextNode(text);

        element.appendChild(txt);
        logger.appendChild(element);
    }

    // Example of getting and setting languages for project masterdata
    const exampleProject = async () => {
        //Create project object with prohect API key
        let project = new Zaza.Project('<apikey>')
        const langs = ['en', 'nl', 'fr']
        let res = await project.setAllLanguages(langs, 'en').catch(err => {
            console.log("error setting project languages")
        })

        let obj = await project.newObject("proj master", true, true, ).catch(err => console.log("Error ", err))

        //Create attribute for project
        console.log("Creatng attribute for project")
        
        property = await obj.newAttribute("Prop 1", 'string', null)
        console.log(`Property : ${JSON.stringify(property)}`)

        prop2 = await obj.newAttribute("Prop 2", 'number', null)
        console.log(`Property : ${JSON.stringify(property)}`)

        //create translation attr
        let langAttr = {
            'fr': 'prop1 fr',
            'nl': 'prop1 nl'
        }
        trans = await obj.addTranslationAttribute(langAttr, property.apiName)
        console.log(`trans : ${JSON.stringify(trans)}`)

        //Get object
        let object = await project.object("proj master")

        //Insert data with structuredObject object
        console.log("Inserting data to created view")
        await object.insert({
            id: "1",
            prop1: "test 1 default english",
            prop1$fr: 'test1 in french',
            prop1$nl: 'test1 in NL',
            prop2: 100
        })

        //get default language value
        defLang = await object.get('');
        console.log(`default lang value : ${JSON.stringify(defLang)}`)
        //get all languages value
        allLangs = await object.get('','all');
        console.log(`all lang value : ${JSON.stringify(allLangs)}`)

        //get specific language
        frLang = await object.get('','fr');
        console.log(`french lang value : ${JSON.stringify(frLang)}`)
    }

    exampleProject()
</script>